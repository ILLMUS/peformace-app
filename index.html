<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>HustleOS Performance Tracker — ORB Pro</title>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<!-- jsPDF + html2canvas -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

<!-- Supabase -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>


<link rel="stylesheet" href="styles.css">
</head>
<body data-theme="dark">
<header>
  <div class="brand">
    <div class="logo">PT</div>
    <div>
      <h1>HustleOS Performance Tracker — ORB Pro</h1>
      <p class="lead">Live prices, heatmap, equity curve, PDFs, analytics — offline-first, mobile-friendly.</p>
    </div>
  </div>
<div id="authButtons" style="display:flex;gap:8px;align-items:center">
  <button id="loginHeaderBtn">Login</button>
  <button id="signupHeaderBtn">Sign Up</button>
</div>


<div id="userBar" style="display:none;text-align:right;margin:10px 0">
  <span id="userEmail"></span>
  <button id="logoutBtn">Logout</button>
</div>

  <div style="display:flex;gap:8px;align-items:center">
    <label class="small">Theme</label>
  
    <select id="themeSel"><option value="dark">Dark</option><option value="light">Light</option></select>
    <button id="downloadAll" class="ghost">Download HTML</button>
  </div>
</header>

<main class="app">
  <!-- LEFT: main tools -->
  <section>
    <div class="card">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div>
          <div class="small">Account</div>
          <div style="font-weight:700" id="acctVal">$850</div>
        </div>
        <div class="small">Auto-saves to your browser</div>
      </div>

      <form id="tradeForm" onsubmit="return false;" style="margin-top:10px">
        <input id="date" type="date" class="full" />
        <select id="pair"><option>US100</option><option>US500</option><option>XAUUSD</option><option>BTCUSD</option><option>EURUSD</option></select>
        <select id="side"><option>Buy</option><option>Sell</option></select>
        <input id="lots" type="number" step="0.01" value="0.05" placeholder="Lots"/>
        <input id="entry" placeholder="Entry price (optional)" />
        <input id="exit" placeholder="Exit price (optional)" />
        <input id="points" placeholder="Points (auto if entry+exit provided)" />
        <input id="result" placeholder="Result $ (optional, auto-calc)" />
        <input id="atr" placeholder="ATR (optional)" />
        <textarea id="notes" class="full" placeholder="Notes (setup, screenshot link)"></textarea>
        <div class="full" style="display:flex;gap:8px">
          <button id="addBtn">Add Trade</button>
          <button id="importBtn" class="ghost" type="button">Import CSV</button>
          <input id="fileInput" type="file" accept=".csv" style="display:none" />
          <button id="clearBtn" class="ghost" type="button">Clear All</button>
        </div>
      </form>

      <div class="small" style="margin-top:8px">Tip: enter entry & exit to auto-calc points. Or paste points directly (positive win, negative loss).</div>
    </div>

    <div class="card" style="margin-top:12px">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div><div class="small">Analytics</div><div style="font-weight:700">Performance Summary</div></div>
        <div class="small">Trades: <span id="tradeCount">0</span></div>
      </div>

      <div class="metrics" id="metricsWrap">
        <div class="metric"><div class="small">Win Rate</div><div id="winRate" style="font-weight:700">0%</div></div>
        <div class="metric"><div class="small">Avg Win</div><div id="avgWin" style="font-weight:700">$0.00</div></div>
        <div class="metric"><div class="small">Avg Loss</div><div id="avgLoss" style="font-weight:700">$0.00</div></div>
        <div class="metric"><div class="small">Expectancy</div><div id="expectancy" style="font-weight:700">$0.00</div></div>
        <div class="metric"><div class="small">Profit Factor</div><div id="pf" style="font-weight:700">0</div></div>
        <div class="metric"><div class="small">Max Drawdown</div><div id="dd" style="font-weight:700">$0</div></div>
      </div>

      <div style="margin-top:12px">
        <canvas id="equityChart"></canvas>
      </div>
    </div>

    <div class="card" style="margin-top:12px;overflow:auto">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div class="small">Trades Log</div>
        <div class="small">Edit lots/result inline</div>
      </div>
      <table id="tradesTable">
        <thead><tr><th>Date</th><th>Pair</th><th>Side</th><th>Lots</th><th>Points</th><th>Result $</th><th>Notes</th><th></th></tr></thead>
        <tbody></tbody>
      </table>
    </div>

  </section>

  <!-- RIGHT: heatmap, calendar, live price, monthly -->
  <aside>
    <div class="card">
      <div style="display:flex;justify-content:space-between;align-items:center"><div><div class="small">Heatmap (Day × Hour)</div><div style="font-weight:700">Performance Heatmap</div></div><div class="small">Green = wins</div></div>
      <div id="heatmap" class="heatmap" style="margin-top:8px"></div>
      <div class="small" style="margin-top:6px">Day-of-week vs hour (aggregated)</div>
    </div>

    <div class="card" style="margin-top:12px">
      <div style="display:flex;justify-content:space-between;align-items:center"><div><div class="small">Calendar</div><div style="font-weight:700">Trade Frequency</div></div><div class="small">Count per day</div></div>
      <div id="calendar" class="calendar"></div>
    </div>

    <div class="card" style="margin-top:12px">
      <div class="small">Live Price Snapshot</div>
      <div style="display:grid;gap:8px;margin-top:8px">
        <select id="provider">
          <option value="twelvedata">TwelveData (easy)</option>
          <option value="finnhub">Finnhub</option>
          <option value="custom">Custom URL</option>
        </select>
        <input id="symbol" placeholder="Symbol (ex: NQ, ^NDX, US500, BTCUSD)" />
        <input id="apiKey" placeholder="API Key" />
        <input id="customUrl" placeholder="Custom URL template (use {symbol} & {apikey})" style="display:none" />
        <div style="display:flex;gap:8px">
          <button id="getPriceBtn">Get Live Price</button>
          <button id="autoPriceBtn" class="ghost">Auto: Off</button>
        </div>
        <div class="small">Example: TwelveData → https://api.twelvedata.com/price?symbol={symbol}&apikey={apikey}</div>
        <div id="livePrice" style="margin-top:8px;font-weight:700">Price: --</div>
      </div>
    </div>

    <div class="card" style="margin-top:12px">
      <div style="display:flex;justify-content:space-between;align-items:center"><div><div class="small">Monthly Report</div><div style="font-weight:700">Export / Print</div></div></div>
      <div style="display:flex;gap:8px;margin-top:8px">
        <button id="monthlyPdfBtn">Download Monthly Report (PDF)</button>
        <button id="downloadCsv" class="ghost">Export CSV</button>
      </div>
    </div>

  </aside>
</main>
<div id="loginModal" style="display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.6);justify-content:center;align-items:center;z-index:9999">
  <div style="background:var(--card);padding:24px;border-radius:12px;max-width:360px;width:90%;display:flex;flex-direction:column;gap:12px">
    <h3>Login / Sign Up</h3>
    <input id="modalEmail" type="email" placeholder="Email" />
    <input id="modalPassword" type="password" placeholder="Password" />
    <div style="display:flex;gap:8px;justify-content:flex-end">
      <button id="modalLoginBtn">Login</button>
      <button id="modalSignupBtn">Sign Up</button>
      <button id="modalCloseBtn" class="ghost">Cancel</button>
    </div>
    <p id="modalMsg" style="color:red;font-size:13px"></p>
  </div>
</div>
<script src="js/globals.js"></script>

<script src="js/supabase.js"></script>

<script src="js/app-state_helpers.js"></script>
<script src="js/utils.js"></script>

<script src="js/domRefs.js"></script>

<script src="js/render_analytics.js"></script>
<script src="js/heatmapCalendar.js"></script>

<script src="js/adding-editing-trades.js"></script>
<script src="js/csv-import-export.js"></script>

<script src="js/livePrice-integration.js"></script>
<script src="js/monthly-pdf-report.js"></script>
<script src="js/download-html.js"></script>

<script src="js/uiHandlers.js"></script>
<script src="js/modal.js"></script>
<script src="js/update-header-ui.js"></script>

<script src="js/auth.js"></script>
<script src="js/login-signup-handler.js"></script>

<script src="js/merge-locals-to-cloud.js"></script>
<script src="js/load-trades.js"></script>

<script src="js/session-restore.js"></script>




</body>
</html>
